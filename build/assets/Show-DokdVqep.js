import{d as l,a as e,F as M,h as j,s as K,n as T,g as p,e as S,t as y,x as Q,o as r,r as k,k as z,y as U,p as R,c as q,w as V,j as G,b as f,m as E,z as J,A as P,B as W,f as L,i as X,l as H,C as B}from"./app-CP4UpOIz.js";import{_ as Y}from"./AppLayout-O7ATnjip.js";import{_ as O}from"./Modal-CG5A3g7A.js";import{_ as Z}from"./InputError-FJw--sEs.js";import{_ as ee}from"./InputLabel-b3uc1hhB.js";import{_ as te}from"./TextInput-DdiJ_QV7.js";import{_ as se}from"./PrimaryButton-CBclvA3J.js";import{_ as I}from"./SecondaryButton-CuuUnyQ1.js";import{_ as re}from"./DangerButton-CMJy3oZz.js";/* empty css            */const ae={class:"overflow-x-auto"},oe={class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},le={class:"bg-gray-50 dark:bg-gray-900"},ne=["onClick"],ie={class:"flex items-center gap-1"},de={key:0,class:"text-xs"},ue={class:"divide-y divide-gray-200 bg-white dark:divide-gray-700 dark:bg-gray-800"},ce={class:"whitespace-nowrap px-6 py-4 text-right text-sm font-medium"},ye={class:"flex items-center justify-end gap-2"},me=["onClick"],ge=["onClick"],ve={key:0},he=["colspan"],pe={__name:"DictionaryTable",props:{columns:{type:Array,required:!0},items:{type:Array,required:!0},sortBy:{type:String,default:null},sortDirection:{type:String,default:"asc"}},emits:["sort","edit","delete"],setup(t,{emit:g}){const n=t,i=g,d=(a,c)=>{const o=a[c.key];return o==null?"—":c.type==="datetime"&&o?new Date(o).toLocaleString("ru-RU",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):o},m=a=>{a.sortable&&i("sort",a.key)},v=a=>a.sortable?n.sortBy!==a.key?"↕️":n.sortDirection==="asc"?"↑":"↓":null;return(a,c)=>(r(),l("div",ae,[e("table",oe,[e("thead",le,[e("tr",null,[(r(!0),l(M,null,j(t.columns,o=>(r(),l("th",{key:o.key,class:T(["px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-400",o.sortable&&"cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-800"]),style:K(o.width?{width:o.width}:{}),onClick:w=>m(o)},[e("div",ie,[p(y(o.label)+" ",1),o.sortable?(r(),l("span",de,y(v(o)),1)):S("",!0)])],14,ne))),128)),c[0]||(c[0]=e("th",{class:"px-6 py-3 text-right text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-400",style:{width:"150px"}}," Действия ",-1))])]),e("tbody",ue,[(r(!0),l(M,null,j(t.items,o=>(r(),l("tr",{key:o.id,class:"hover:bg-gray-50 dark:hover:bg-gray-700/50"},[(r(!0),l(M,null,j(t.columns,w=>(r(),l("td",{key:w.key,class:"whitespace-nowrap px-6 py-4 text-sm text-gray-900 dark:text-gray-100"},y(d(o,w)),1))),128)),e("td",ce,[e("div",ye,[e("button",{type:"button",onClick:w=>i("edit",o),class:"rounded p-1 text-blue-600 transition hover:bg-blue-50 dark:text-blue-400 dark:hover:bg-blue-900/20",title:"Редактировать"},[...c[1]||(c[1]=[e("svg",{class:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)])],8,me),e("button",{type:"button",onClick:w=>i("delete",o),class:"rounded p-1 text-red-600 transition hover:bg-red-50 dark:text-red-400 dark:hover:bg-red-900/20",title:"Удалить"},[...c[2]||(c[2]=[e("svg",{class:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,ge)])])]))),128)),t.items.length===0?(r(),l("tr",ve,[e("td",{colspan:t.columns.length+1,class:"px-6 py-12 text-center text-sm text-gray-500 dark:text-gray-400"},[...c[3]||(c[3]=[Q('<div class="flex flex-col items-center gap-2"><svg class="h-12 w-12 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"></path></svg><p class="font-medium">Нет записей</p><p class="text-xs">Добавьте первую запись в справочник</p></div>',1)])],8,he)])):S("",!0)])])]))}},xe={class:"p-6"},ke={class:"mb-6"},fe={class:"text-lg font-medium text-gray-900 dark:text-gray-100"},be={class:"mt-1 text-sm text-gray-600 dark:text-gray-400"},we=["id","onUpdate:modelValue","placeholder","required"],_e=["id","onUpdate:modelValue","required"],$e={value:"",class:"text-gray-500 dark:text-gray-400 dark:bg-gray-700"},Ce=["value"],Se={key:3,class:"text-xs text-gray-500 dark:text-gray-400"},Ve={class:"mt-6 flex items-center justify-end gap-3"},Me={key:0},je={key:1},qe={__name:"CreateEditModal",props:{show:{type:Boolean,default:!1},dictionary:{type:Object,required:!0},item:{type:Object,default:null},isEditing:{type:Boolean,default:!1}},emits:["close","submit"],setup(t,{emit:g}){const n=t,i=g,d=k({}),m=k({}),v=k(!1),a=z(()=>n.isEditing&&!!n.item),c=z(()=>a.value?`Редактировать ${n.dictionary.singular_name.toLowerCase()}`:`Создать ${n.dictionary.singular_name.toLowerCase()}`),o=()=>{if(!n.dictionary||!n.dictionary.form_fields)return;const C={};n.dictionary.form_fields.forEach(b=>{a.value&&n.item?C[b.key]=n.item[b.key]??b.default??"":C[b.key]=b.default??""}),d.value=C,m.value={}};U(()=>n.show,async C=>{C&&(await R(),o())},{immediate:!0});const w=()=>{v.value=!0,m.value={},i("submit",d.value),setTimeout(()=>{v.value=!1},500)},$=()=>{d.value={},m.value={},v.value=!1,i("close")};return(C,b)=>(r(),q(O,{show:t.show,onClose:$,"max-width":"2xl"},{default:V(()=>[e("div",xe,[e("div",ke,[e("h3",fe,y(c.value),1),e("p",be,y(t.dictionary.description),1)]),e("form",{onSubmit:G(w,["prevent"]),class:"space-y-4"},[(r(!0),l(M,null,j(t.dictionary.form_fields,s=>(r(),l("div",{key:s.key,class:"space-y-2"},[f(ee,{for:s.key,value:s.label,required:s.required},null,8,["for","value","required"]),s.type==="text"||s.type==="email"||s.type==="number"?(r(),q(te,{key:0,id:s.key,modelValue:d.value[s.key],"onUpdate:modelValue":x=>d.value[s.key]=x,type:s.type,placeholder:s.placeholder,required:s.required,class:"w-full"},null,8,["id","modelValue","onUpdate:modelValue","type","placeholder","required"])):s.type==="textarea"?E((r(),l("textarea",{key:1,id:s.key,"onUpdate:modelValue":x=>d.value[s.key]=x,placeholder:s.placeholder,required:s.required,rows:"3",class:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100"},null,8,we)),[[J,d.value[s.key]]]):s.type==="select"?E((r(),l("select",{key:2,id:s.key,"onUpdate:modelValue":x=>d.value[s.key]=x,required:s.required,class:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 [&>option]:text-gray-900 [&>option]:dark:text-gray-100 [&>option]:dark:bg-gray-700"},[e("option",$e,y(s.placeholder||"Выберите..."),1),(r(!0),l(M,null,j(s.options,x=>(r(),l("option",{key:x.value,value:x.value,class:"text-gray-900 dark:text-gray-100 dark:bg-gray-700"},y(x.label),9,Ce))),128))],8,_e)),[[P,d.value[s.key]]]):S("",!0),s.help?(r(),l("p",Se,y(s.help),1)):S("",!0),m.value[s.key]?(r(),q(Z,{key:4,message:m.value[s.key]},null,8,["message"])):S("",!0)]))),128)),e("div",Ve,[f(I,{type:"button",onClick:$},{default:V(()=>[...b[0]||(b[0]=[p(" Отмена ",-1)])]),_:1}),f(se,{type:"submit",disabled:v.value},{default:V(()=>[v.value?(r(),l("span",Me,"Сохранение...")):(r(),l("span",je,y(a.value?"Сохранить":"Создать"),1))]),_:1},8,["disabled"])])],32)])]),_:1},8,["show"]))}},Be={class:"p-6"},De={class:"mt-4 text-center"},Le={class:"text-lg font-medium text-gray-900 dark:text-gray-100"},ze={key:0,class:"mt-2 text-sm text-gray-600 dark:text-gray-400"},Ee={class:"font-semibold"},He={class:"mt-6 flex items-center justify-center gap-3"},Te={key:0},Ue={key:1},Oe={__name:"DeleteConfirmModal",props:{show:{type:Boolean,default:!1},dictionary:{type:Object,required:!0},item:{type:Object,default:null}},emits:["close","confirm"],setup(t,{emit:g}){const n=g,i=k(!1),d=()=>{i.value=!0,n("confirm"),setTimeout(()=>{i.value=!1},500)},m=()=>{i.value=!1,n("close")};return(v,a)=>(r(),q(O,{show:t.show,onClose:m,"max-width":"md"},{default:V(()=>[e("div",Be,[a[4]||(a[4]=e("div",{class:"mx-auto flex h-12 w-12 items-center justify-center rounded-full bg-red-100 dark:bg-red-900/20"},[e("svg",{class:"h-6 w-6 text-red-600 dark:text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})])],-1)),e("div",De,[e("h3",Le," Удалить "+y(t.dictionary.singular_name.toLowerCase())+"? ",1),t.item?(r(),l("div",ze,[e("p",null,[a[0]||(a[0]=p(" Вы действительно хотите удалить ",-1)),e("span",Ee,y(t.item.name),1),a[1]||(a[1]=p("? ",-1))]),a[2]||(a[2]=e("p",{class:"mt-1 text-red-600 dark:text-red-400"}," Это действие нельзя будет отменить. ",-1))])):S("",!0)]),e("div",He,[f(I,{type:"button",onClick:m},{default:V(()=>[...a[3]||(a[3]=[p(" Отмена ",-1)])]),_:1}),f(re,{type:"button",onClick:d,disabled:i.value},{default:V(()=>[i.value?(r(),l("span",Te,"Удаление...")):(r(),l("span",Ue,"Удалить"))]),_:1},8,["disabled"])])])]),_:1},8,["show"]))}},Ie={class:"relative flex-1"},Ae=["value","placeholder"],Ne={key:0,class:"absolute inset-y-0 right-0 flex items-center pr-3"},Fe={__name:"SearchInput",props:{modelValue:{type:String,default:""},placeholder:{type:String,default:"Поиск..."}},emits:["update:modelValue","search"],setup(t,{emit:g}){const n=t,i=g,d=k(n.modelValue);U(()=>n.modelValue,c=>{d.value=c});const m=c=>{d.value=c.target.value,i("update:modelValue",c.target.value)},v=()=>{i("search")},a=()=>{d.value="",i("update:modelValue",""),i("search")};return(c,o)=>(r(),l("div",Ie,[o[1]||(o[1]=e("div",{class:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3"},[e("svg",{class:"h-5 w-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1)),e("input",{type:"text",value:d.value,placeholder:t.placeholder,onInput:m,onKeydown:W(v,["enter"]),class:"block w-full rounded-md border-gray-300 py-2 pl-10 pr-10 text-sm focus:border-blue-500 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 dark:placeholder-gray-400"},null,40,Ae),d.value?(r(),l("div",Ne,[e("button",{type:"button",onClick:a,class:"rounded p-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-200",title:"Очистить"},[...o[0]||(o[0]=[e("svg",{class:"h-4 w-4",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})],-1)])])])):S("",!0)]))}},Ke={class:"py-12"},Qe={class:"mx-auto max-w-7xl sm:px-6 lg:px-8"},Re={class:"mb-6"},Ge={class:"flex items-center gap-2 text-sm text-gray-600 dark:text-gray-400"},Je={class:"text-gray-900 dark:text-gray-100"},Pe={class:"mt-2 flex items-center justify-between"},We={class:"text-2xl font-semibold text-gray-800 dark:text-gray-100"},Xe={class:"mt-1 text-sm text-gray-600 dark:text-gray-400"},Ye={class:"overflow-hidden rounded-lg bg-white shadow dark:bg-gray-800"},Ze={class:"border-b border-gray-200 bg-gray-50 p-4 dark:border-gray-700 dark:bg-gray-900/50"},et={class:"flex items-center justify-between gap-4"},tt={class:"text-sm text-gray-600 dark:text-gray-400"},st={class:"font-semibold"},rt={key:0,class:"border-t border-gray-200 bg-gray-50 px-4 py-3 dark:border-gray-700 dark:bg-gray-900/50"},at={class:"flex items-center justify-between"},ot={class:"text-sm text-gray-700 dark:text-gray-300"},lt={class:"font-medium"},nt={class:"font-medium"},it={class:"font-medium"},dt={class:"flex gap-1"},ft={__name:"Show",props:{dictionary:{type:Object,required:!0},items:{type:Object,required:!0},filters:{type:Object,default:()=>({})}},setup(t){const g=t,n=k(!1),i=k(!1),d=k(!1),m=k(null),v=k(null),a=k(g.filters.search||""),c=()=>{n.value=!0},o=h=>{m.value=h,i.value=!0},w=h=>{v.value=h,d.value=!0},$=()=>{n.value=!1,i.value=!1,d.value=!1,m.value=null,v.value=null},C=()=>{B.get(route("dictionaries.show",g.dictionary.key),{search:a.value},{preserveState:!0,preserveScroll:!0})},b=h=>{const u=g.filters.sort_by,_=g.filters.sort_direction||"asc";let D="asc";u===h&&(D=_==="asc"?"desc":"asc"),B.get(route("dictionaries.show",g.dictionary.key),{...g.filters,sort_by:h,sort_direction:D},{preserveState:!0,preserveScroll:!0})},s=h=>{B.post(route("dictionaries.store",g.dictionary.key),h,{preserveScroll:!0,onSuccess:()=>$()})},x=(h,u)=>{B.put(route("dictionaries.update",[g.dictionary.key,h]),u,{preserveScroll:!0,onSuccess:()=>$()})},A=h=>{B.delete(route("dictionaries.destroy",[g.dictionary.key,h]),{preserveScroll:!0,onSuccess:()=>$()})},N=h=>{i.value&&m.value?x(m.value.id,h):s(h)},F=()=>{v.value&&v.value.id&&A(v.value.id)};return(h,u)=>(r(),q(Y,{title:t.dictionary.name},{default:V(()=>[f(L(X),{title:t.dictionary.name},null,8,["title"]),e("div",Ke,[e("div",Qe,[e("div",Re,[e("div",Ge,[f(L(H),{href:h.route("dictionaries.index"),class:"hover:text-gray-900 dark:hover:text-gray-200"},{default:V(()=>[...u[1]||(u[1]=[p(" Справочники ",-1)])]),_:1},8,["href"]),u[2]||(u[2]=e("span",null,"/",-1)),e("span",Je,y(t.dictionary.name),1)]),e("div",Pe,[e("div",null,[e("h2",We,y(t.dictionary.icon)+" "+y(t.dictionary.name),1),e("p",Xe,y(t.dictionary.description),1)]),e("button",{type:"button",onClick:c,class:"inline-flex items-center gap-2 rounded-md bg-blue-600 px-4 py-2 text-sm font-semibold text-white shadow-sm transition hover:bg-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-blue-500 dark:hover:bg-blue-400"},[...u[3]||(u[3]=[e("svg",{class:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),p(" Добавить ",-1)])])])]),e("div",Ye,[e("div",Ze,[e("div",et,[f(Fe,{modelValue:a.value,"onUpdate:modelValue":u[0]||(u[0]=_=>a.value=_),placeholder:"Поиск в справочнике...",onSearch:C},null,8,["modelValue"]),e("div",tt,[u[4]||(u[4]=p(" Всего записей: ",-1)),e("span",st,y(t.items.total),1)])])]),f(pe,{columns:t.dictionary.table_columns,items:t.items.data,"sort-by":t.filters.sort_by,"sort-direction":t.filters.sort_direction,onSort:b,onEdit:o,onDelete:w},null,8,["columns","items","sort-by","sort-direction"]),t.items.links.length>3?(r(),l("div",rt,[e("div",at,[e("div",ot,[u[5]||(u[5]=p(" Показано с ",-1)),e("span",lt,y(t.items.from),1),u[6]||(u[6]=p(" по ",-1)),e("span",nt,y(t.items.to),1),u[7]||(u[7]=p(" из ",-1)),e("span",it,y(t.items.total),1),u[8]||(u[8]=p(" записей ",-1))]),e("nav",dt,[(r(!0),l(M,null,j(t.items.links,(_,D)=>(r(),q(L(H),{key:D,href:_.url,class:T(["rounded px-3 py-1 text-sm transition",_.active?"bg-blue-600 text-white":"bg-white text-gray-700 hover:bg-gray-100 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700",!_.url&&"cursor-not-allowed opacity-50"]),disabled:!_.url,"preserve-scroll":"",innerHTML:_.label},null,8,["href","class","disabled","innerHTML"]))),128))])])])):S("",!0)])])]),f(qe,{dictionary:t.dictionary,item:m.value,show:n.value||i.value,"is-editing":i.value,onClose:$,onSubmit:N},null,8,["dictionary","item","show","is-editing"]),f(Oe,{dictionary:t.dictionary,item:v.value,show:d.value,onClose:$,onConfirm:F},null,8,["dictionary","item","show"])]),_:1},8,["title"]))}};export{ft as default};
